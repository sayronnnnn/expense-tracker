# Deployment Quick Commands

**Save this for quick reference during deployment!**

## Fly.io Backend Deployment

```powershell
# 1. LOGIN & INITIALIZE
flyctl auth login
cd c:\GitClone\Cyron\expense-tracker
flyctl launch --no-deploy

# 2. SET SECRETS (sensitive data)
flyctl secrets set MONGODB_URL="mongodb+srv://user:pass@cluster.mongodb.net/?appName=expense_tracker"
flyctl secrets set JWT_SECRET="your-random-32-char-string-here"
flyctl secrets set CORS_ORIGINS="https://expense-tracker-xxxxx.vercel.app,http://localhost:5173"
flyctl secrets set GROQ_API_KEY="gsk_your-key-here"

# 3. SET ENVIRONMENT VARIABLES
flyctl config set ENVIRONMENT="production"
flyctl config set DEBUG="false"
flyctl config set APP_NAME="Expense Tracker API"

# 4. DEPLOY
flyctl deploy

# 5. VERIFY
flyctl logs --follow
curl https://[YOUR_FLY_URL]/health
```

## Vercel Frontend Deployment

```bash
# 1. UPDATE .ENV
# Edit frontend/.env.production:
VITE_API_URL=https://expense-tracker-api-xxxxx.fly.dev

# 2. PUSH TO GITHUB
git add .
git commit -m "Deployment setup"
git push origin main

# 3. DEPLOY ON VERCEL
# Visit: https://vercel.com/new
# - Import GitHub repo
# - Set build: npm run build from frontend/
# - Add env var: VITE_API_URL=[FLY_URL]
# - Deploy
```

## Update Backend CORS After Vercel Deploy

```powershell
# After Vercel gives you the URL:
flyctl secrets set CORS_ORIGINS="https://[VERCEL_URL].vercel.app,http://localhost:5173"
flyctl deploy
```

## Monitor Production

```powershell
# View logs
flyctl logs

# Get app info
flyctl apps info

# Check status
flyctl status

# Restart app
flyctl apps restart

# List deployed versions
flyctl releases

# Rollback to previous
flyctl releases rollback [RELEASE_ID]
```

## Troubleshoot

```powershell
# Test health check
curl https://[FLY_URL]/health

# Test API endpoint
curl -X GET https://[FLY_URL]/api/v1/categories `
  -H "Authorization: Bearer [TOKEN]"

# View secrets
flyctl secrets list

# Check CORS headers
curl -i -X OPTIONS https://[FLY_URL]/api/v1/notifications `
  -H "Origin: https://[VERCEL_URL].vercel.app"
```

## Database Backup

```powershell
# Visit MongoDB Atlas: https://cloud.mongodb.com
# Dashboard → Backups → View Backups
# Automatic daily snapshots are saved for 7 days
```

---

**Key URLs to Save:**
- Frontend: `https://expense-tracker-xxxxx.vercel.app` (from Vercel)
- Backend API: `https://expense-tracker-api-xxxxx.fly.dev` (from Fly.io)
- MongoDB: `https://cloud.mongodb.com` (already have login)
- Fly.io Dashboard: `https://fly.io/apps`
- Vercel Dashboard: `https://vercel.com/dashboard`
